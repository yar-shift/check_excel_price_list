function sendToTelegram() {
  var token = '7898763376:AAEl911rDyNebfnHx_oc2_pd7WK4GfcARk4'; // –¢–æ–∫–µ–Ω —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞
  var chatId = '799425277'; // ID —á–∞—Ç–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫—É–¥–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ

  // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  
  // –ò–º—è —Ñ–∞–π–ª–∞: –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ + –¥–∞—Ç–∞
  //var fileName = sheet.getName() + ' ' + Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'dd.MM.yyyy') + '.xlsx';
  var fileName = sheet.getName()  + '.xlsx';
  
  // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ª–∏—Å—Ç –≤ —Ñ–æ—Ä–º–∞—Ç Excel (.xlsx)
  var url = 'https://docs.google.com/spreadsheets/d/' + SpreadsheetApp.getActiveSpreadsheet().getId() + '/export?format=xlsx&id=' + SpreadsheetApp.getActiveSpreadsheet().getId() + '&gid=' + sheet.getSheetId();
  
  var options = {
    method: 'get',
    muteHttpExceptions: true,
    headers: {
      'Authorization': 'Bearer ' + ScriptApp.getOAuthToken(),
    }
  };

  var response = UrlFetchApp.fetch(url, options);
  var fileBlob = response.getBlob().setName(fileName); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –≤ Telegram
  var telegramUrl = 'https://api.telegram.org/bot' + token + '/sendDocument';
  var formData = {
    method: 'post',
    payload: {
      chat_id: chatId,
      document: fileBlob,
      filename: fileName
    }
  };

  UrlFetchApp.fetch(telegramUrl, formData);
  Logger.log('–§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram!');

  // –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ —Å –∫–Ω–æ–ø–∫–æ–π –û–ö
  showConfirmationDialog();
}

function showConfirmationDialog() {
  var html = HtmlService.createHtmlOutput('<html><body>' +
    '<h2>–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ üì¨ Telegram</h2>' +
    '<p>–í–∞—à —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram!</p>' +
    '<button onclick="google.script.host.close()">–û–ö</button>' +
    '</body></html>')
    .setWidth(300)
    .setHeight(150);
  
  SpreadsheetApp.getUi().showModalDialog(html, '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ');
}
